<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (C) 2021 kellypaulinc

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core">
    <ui:composition template="/WEB-INF/template.xhtml">
        <ui:param name="sitename" value="#{i18n['Sitename']}"/>
        <ui:define name="title">#{i18n['app.name']}</ui:define>
        <ui:define name="viewname">
            <li>#{i18n['app.name']}</li>
            <li>/</li>
            <li><p:link outcome="/pages/fede/accounting/account_items.jsf">#{i18n['app.fede.accouting.accounts']}</p:link></li>
        </ui:define>
        <ui:define name="content">
            <div class="ui-g">
                <div class="ui-g-12">
                    <div class="card">
<!--                        <label class="Gray">#{i18n['Start']}</label>
                        <p:calendar value="#{accountHome.start}" class="input-sm">
                            <p:ajax event="dateSelect" listener="#{accountHome.clear()}" oncomplete="form.submit();"/>
                        </p:calendar>
                        <label class="Gray">#{i18n['End']}</label>
                        <p:calendar value="#{accountHome.end}" class="input-sm">
                            <p:ajax event="dateSelect" listener="#{accountHome.clear()}" oncomplete="form.submit();"/>
                        </p:calendar>                        
                        <label class="Gray">#{i18n['Find']}</label>
                        <p:inputText value="#{accountHome.keyword}" class="input-sm"></p:inputText>
                        <p:commandButton value="#{i18n['Find']}" style="margin-bottom: 10px;" styleClass="raised-btn"
                                         actionListener="#{accountHome.clear()}" ajax="false">
                        </p:commandButton>
                        <label class="Gray">#{i18n['Find']}</label>
                        <p:inputText id="globalFilter" onkeyup="PF(':form:treeTable').filter(#{account.name})" style="width:10rem"/>-->
                        <p:button value="#{i18n['New']}" styleClass="danger-btn" outcome="/pages/fede/accounting/account.jsf"/>
                    </div>
                    <div class="card">
                        <h:form id="form">
                            <p:treeTable var="account" value="#{accountHome.treeDataModel}"
                                         paginator="true" rows="#{settingHome.getValue('fede.inbox.list.length', '50')}" 
                                         sortOrder="#{settingHome.getValue('fede.inbox.dataTable.sortOrder', 'DESCENDING')}"
                                         resizableColumns="#{settingHome.getValue('fede.inbox.dataTable.resizableColumns', 'true')}"
                                         selection="#{accountHome.singleSelectedNode}" filteredNode="#{accountHome.singleSelectedNode}"
                                         id="dataTable" widgetVar="treeTable" selectionMode="single">
                                <!--                                <f:facet name="header">
                                                                    <div class="p-d-flex p-ai-center p-jc-between">
                                                                        <p:inputText id="globalFilter" onkeyup="PF('treeTable').filter()" style="width:10rem" placeholder="Enter keyword" />
                                                                    </div>
                                                                </f:facet>-->
                                <p:ajax event="select" listener="#{accountHome.onNodeSelect}" update="dataTable"/>
                                <p:column headerText="#{i18n['common.code']}" sortBy="#{account.code}" filterable="false" style="width: auto">
                                    <h:outputText value="#{account.code}" />
                                </p:column>
                                <p:column headerText="#{i18n['name']}" sortBy="#{account.name}" filterBy="#{account.name}" style="width: 50%">
                                    <h:outputText value="#{account.name}" />
                                </p:column>
                                <p:column  id="fechaEmision"  headerText="#{i18n['common.crationDate']}" sortBy="#{account.createdOn}" filterable="false"
                                           styleClass="text-right">
                                    <h:outputText value="#{account.createdOn}">
                                        <f:convertDateTime pattern="#{settingHome.getValue('fede.date.pattern', 'dd/MM/yyyy')}" />
                                    </h:outputText>
                                </p:column>
                                <p:column style="width:3rem">
                                    <p:commandButton update="form" oncomplete="PF('generalLedgerDialog').show()"
                                                     title="#{i18n['module.accounting.generalLedger']}" icon="fa fa-book" action="#{accountHome.findRecordDetailAccountTop()}">
                                        <f:setPropertyActionListener value="#{account}" target="#{accountHome.accountSelected}"/>
                                    </p:commandButton>
                                </p:column>
                            </p:treeTable>
                            <p:dialog widgetVar="generalLedgerDialog" modal="true" resizable="false" 
                                      showEffect="fade" hideEffect="fade" closeOnEscape="true" fitViewport="true"
                                      class="Container100 Responsive50" style="text-align: right" width="60%" header="Libro Mayor">
                                <p:outputPanel id="generalLedger">
                                        <p:dataTable id="recordsDataTable" widgetVar="dataTable_wv" var="recordDetail"
                                                     value="#{accountHome.objectsRecordDetail}" rowKey="#{recordDetail.id}" 
                                                     paginator="true" rows="#{settingHome.getValue('fede.inbox.list.length', '10')}" paginatorAlwaysVisible="false"
                                                     resizableColumns="#{settingHome.getValue('fede.inbox.dataTable.resizableColumns', 'true')}"
                                                     scrollable="true" liveScroll="true" scrollRows="10" scrollHeight="175"
                                                     lazy="false" reflow="true">
                                            <p:columnGroup type="header">
                                                <p:row>
                                                    <p:column rowspan="2" colspan="2" headerText="Monto acumulado anterior" style="text-align: right"/>
                                                </p:row>
                                                <p:row>
                                                    <p:column headerText="$#{accountHome.amountDebeRdOld}" style="text-align: right"/>
                                                    <p:column headerText="$#{accountHome.amountHaberRdOld}" style="text-align: right"/>
                                                </p:row>
                                                <p:row>
                                                    <p:column headerText="#{i18n['common.crationDate']}"/>
                                                    <p:column headerText="#{i18n['common.concept']}"/>
                                                    <p:column headerText="#{i18n['app.fede.sales.journal.record.debe']}"/>
                                                    <p:column headerText="#{i18n['app.fede.sales.journal.record.haber']}"/>
                                                </p:row>
                                            </p:columnGroup>
                                            <p:column  id="fechaEmision"  headerText="#{i18n['common.crationDate']}" style="width: 15%">
                                                <h:outputText value="#{recordDetail[0]}">
                                                    <f:convertDateTime dateStyle="long" timeZone="EST" type="both"  pattern="#{settingHome.getValue('fede.datetime.pattern', 'dd/MM/yyyy HH:mm:ss')}"/>
                                                </h:outputText>
                                            </p:column>
                                            <p:column headerText="#{i18n['common.concept']}" style="width: 60%">
                                                <h:outputText value="#{recordDetail[1]}" />
                                            </p:column>
                                            <p:column headerText="#{i18n['app.fede.sales.journal.record.debe']}" style="width: auto">
                                                <h:outputText value="$#{recordDetail[2]}" rendered="#{recordDetail[3]=='DEBE'}" style="text-align: right"/>
                                            </p:column>
                                            <p:column headerText="#{i18n['app.fede.sales.journal.record.haber']}" style="width: auto">
                                                <h:outputText value="$#{recordDetail[2]}" rendered="#{recordDetail[3]=='HABER'}" style="text-align: right"/>
                                            </p:column>
                                        </p:dataTable>
                                </p:outputPanel>
                            </p:dialog>
                        </h:form>
                    </div>
                </div>
            </div>
        </ui:define>
    </ui:composition>
</html>
<!--                                        <p:dataTable id="recordsDataTable" widgetVar="dataTable_wv" var="recordDetail"
                                                     value="#{generalJournalHome.record.recordDetails}" rowKey="#{recordDetail.id}" 
                                                     paginator="true" rows="#{settingHome.getValue('fede.inbox.list.length', '10')}" paginatorAlwaysVisible="false"
                                                     resizableColumns="#{settingHome.getValue('fede.inbox.dataTable.resizableColumns', 'true')}"
                                                     scrollable="true" liveScroll="true" scrollRows="10" scrollHeight="175"
                                                     lazy="false" reflow="true">
                                            <p:column  id="fechaEmision"  headerText="#{i18n['common.crationDate']}" sortBy="#{recordDetail.createdOn}" style="width: 10%">
                                                <h:outputText value="#{recordDetail.createdOn}">
                                                    <f:convertDateTime pattern="#{settingHome.getValue('fede.date.pattern', 'dd/MM/yyyy')}" />
                                                </h:outputText>
                                            </p:column>
                                            <p:column headerText="#{i18n['common.concept']}" sortBy="#{record.description}" style="width: 30%">
                                                <h:outputText value="#{record.description}" />
                                            </p:column>
                                            <p:column headerText="#{i18n['app.fede.sales.journal.record.debe']}">
                                                <h:outputText value="#{recordDetail.amount}" rendered="#{recordDetail.recordType=='DEBE'}" style="text-align: right"/>
                                            </p:column>
                                            <p:column headerText="#{i18n['app.fede.sales.journal.record.haber']}">
                                                <h:outputText value="#{recordDetail.amount}" rendered="#{recordDetail.recordType=='DEBE'}" style="text-align: right"/>
                                            </p:column>
                                            <p:column headerText="#{i18n['app.fede.sales.journal.record.debe']}">
                                                <p:cellEditor>
                                                    <f:facet name="output">
                                                        <h:outputText value="$#{recordDetail.amount}" rendered="#{recordDetail.recordType=='DEBE'}" style="text-align: right"/>
                                                    </f:facet>
                                                    <f:facet name="input">
                                                        <p:inputText value="#{recordDetail.amount}"     
                                                                     rendered="#{recordDetail.recordType=='DEBE'}" label="app.fede.sales.journal.record.debe"/>
                                                    </f:facet>
                                                </p:cellEditor>
                                            </p:column>
                                            <p:column headerText="#{i18n['app.fede.sales.journal.record.haber']}">
                                                <p:cellEditor>
                                                    <f:facet name="output">
                                                        <h:outputText value="$#{recordDetail.amount}" rendered="#{recordDetail.recordType=='HABER'}" style="text-align: right"/>
                                                    </f:facet>
                                                    <f:facet name="input">
                                                        <p:inputText value="#{recordDetail.amount}" 
                                                                     rendered="#{recordDetail.recordType=='HABER'}" label="app.fede.sales.journal.record.debe"/>
                                                    </f:facet>
                                                </p:cellEditor>
                                            </p:column>
                                            <p:column style="width: auto">
                                                <p:rowEditor editTitle="Edit Row" cancelTitle="Cancel Edit" saveTitle="Save Row"/>
                                            </p:column>
                                        </p:dataTable>-->

<!--                                        <p:dataTable var="accountSelected"
                                                     value="#{accountHome.accountSelected}"
                                                     paginator="true" rows="#{settingHome.getValue('fede.inbox.list.length', '50')}" 
                                                     sortOrder="#{settingHome.getValue('fede.inbox.dataTable.sortOrder', 'DESCENDING')}"
                                                     reflow="true" selection="#{accountHome.accountSelected}"
                                                     rowKey="#{account.id}"
                                                     resizableColumns="#{settingHome.getValue('fede.inbox.dataTable.resizableColumns', 'true')}" 
                                                     id="dataTableSelected" widgetVar="dataTable_wv" lazy="true">
                                            <p:column headerText="#{i18n['common.code']}" sortBy="#{account.code}">
                                                <h:outputText value="#{accountSelected.code}" />
                                            </p:column>
                                            <p:column headerText="#{i18n['name']}" sortBy="#{account.name}">
                                                <h:outputText value="#{accountSelected.name}" />
                                            </p:column>
                                            <p:column  id="fechaEmision"  headerText="#{i18n['common.crationDate']}" sortBy="#{account.createdOn}"
                                                       styleClass="text-right">
                                                <h:outputText value="#{accountSelected.createdOn}">
                                                    <f:convertDateTime pattern="#{settingHome.getValue('fede.date.pattern', 'dd/MM/yyyy')}" />
                                                </h:outputText>
                                            </p:column>
                                        </p:dataTable>-->
<!--                                        <h2 class="BigTopic" style="font-weight: bold">#{i18n['app.fede.accouting.account']}</h2>
<ui:repeat value="#{inventoryHome.findTop()}" var="product">  
    <p:commandButton ajax="true" update="@form" immediate="true"
                     actionListener="#{invoiceHome.touch(product)}" disabled="#{false}"
                     icon="#{product.icon}" styleClass="success-btn" title="#{product.name}"
                     style="width:36px; height: 36px;">
    </p:commandButton>
    <h:outputText value="#{product.name}"/>
</ui:repeat>-->